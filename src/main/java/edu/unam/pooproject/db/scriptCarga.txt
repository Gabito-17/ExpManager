-- Insertar personas que serán miembros o involucradas en expedientes
INSERT INTO persona (dni, nombre, apellido, fechanacimiento, esmiembro, email)
VALUES
    ('12345678', 'Juan', 'González', '1995-05-15', true, 'juan@example.com'),
    ('23456789', 'María', 'Martínez', '1998-08-20', false, 'maria@example.com'),
    ('34567890', 'Pedro', 'Sánchez', '1990-03-10', true, 'pedro@example.com'),
    ('45678901', 'Ana', 'López', '1997-11-25', false, 'ana@example.com'),
    ('56789012', 'Carlos', 'Fernández', '1993-07-03', false, 'carlos@example.com');

-- Insertar expedientes relacionados con las personas
INSERT INTO expediente (titulo, nota, fechaingreso, estado, iniciante_id)
VALUES
    ('Trabajo de Investigación en Ingeniería', 'Realizar un estudio detallado sobre un tema de interés en el campo de la ingeniería.', CURRENT_DATE - INTERVAL '30' DAY * (random() * 365), true, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    ('Proyecto de Laboratorio de Química', 'Desarrollar un experimento práctico para aplicar los conocimientos adquiridos en la materia de química.', CURRENT_DATE - INTERVAL '30' DAY * (random() * 365), false, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    ('Tesis de Maestría en Biología', 'Investigar un tema específico en el campo de la biología y presentar los hallazgos de manera académica.', CURRENT_DATE - INTERVAL '30' DAY * (random() * 365), true, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1));

-- Insertar reuniones relacionadas con las personas y los expedientes
INSERT INTO reunion (fecha, detalles, lugar, horaInicio, horaFin, estado)
VALUES
    ('2024-04-09', 'Reunión para discutir avances en el Trabajo de Investigación en Ingeniería', 'Sala de reuniones A', '09:00', '11:00', CASE WHEN '2024-04-09' < CURRENT_DATE THEN true ELSE false END),
    ('2024-04-10', 'Reunión para revisar el Proyecto de Laboratorio de Química', 'Sala de conferencias B', '10:00', '12:00', CASE WHEN '2024-04-10' < CURRENT_DATE THEN true ELSE false END),
    ('2024-04-11', 'Reunión para planificar la presentación de la Tesis de Maestría en Biología', 'Sala de juntas C', '11:00', '13:00', CASE WHEN '2024-04-11' < CURRENT_DATE THEN true ELSE false END);

-- Insertar relaciones entre expedientes y personas involucradas
INSERT INTO expediente_involucrado (expediente_id, involucrado_id)
VALUES
    (1, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    (1, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    (2, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    (2, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    (3, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1)),
    (3, (SELECT dni FROM persona WHERE esmiembro = true ORDER BY random() LIMIT 1));

-- Insertar relaciones entre expedientes y reuniones
INSERT INTO expediente_reuniones (expediente_id, reunion_id)
VALUES
    (1, 1),
    (2, 2),
    (3, 3);

-- Insertar relaciones entre reuniones y personas sin repetir un miembro en una reunión
INSERT INTO reunion_miembro (reunion_id, miembro_id)
VALUES
    (1, (SELECT dni FROM persona WHERE esmiembro = true AND dni NOT IN (SELECT miembro_id FROM reunion_miembro WHERE reunion_id = 1) ORDER BY random() LIMIT 1)),
    (1, (SELECT dni FROM persona WHERE esmiembro = true AND dni NOT IN (SELECT miembro_id FROM reunion_miembro WHERE reunion_id = 1) ORDER BY random() LIMIT 1)),
    (2, (SELECT dni FROM persona WHERE esmiembro = true AND dni NOT IN (SELECT miembro_id FROM reunion_miembro WHERE reunion_id = 2) ORDER BY random() LIMIT 1)),
    (2, (SELECT dni FROM persona WHERE esmiembro = true AND dni NOT IN (SELECT miembro_id FROM reunion_miembro WHERE reunion_id = 2) ORDER BY random() LIMIT 1));
